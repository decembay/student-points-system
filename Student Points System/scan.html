<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Scan QR - Update Points</title>
    <?!= HtmlService.createHtmlOutputFromFile('styles').getContent(); ?>
  </head>
  <body>
    <div class="container">
      <h2>üéØ Update Student Points</h2>
      <div id="student-info"></div>
      <div class="btn-group">
        <button onclick="updatePoints(1)">+1 Good</button>
        <button onclick="updatePoints(-1)">-1 Bad</button>
      </div>
      <p id="status"></p>
    </div>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const studentId = urlParams.get("id");

      function loadStudent() {
        google.script.run.withSuccessHandler(function(student){
          if(student){
            document.getElementById("student-info").innerHTML = 
              `<h3>${student.Name} (${student.Class})</h3><p>Points: ${student.Points}</p>`;
          } else {
            document.getElementById("student-info").innerHTML = "‚ùå Student not found.";
          }
        }).getStudentById(studentId);
      }

      function updatePoints(change){
        google.script.run.withSuccessHandler(function(newPoints){
          document.getElementById("status").innerText = "Updated! New Points: " + newPoints;
          loadStudent();
        }).updateStudentPoints(studentId, change);
      }

      loadStudent();
    </script>
  </body>
</html>
